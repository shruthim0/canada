<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Backend Lesson Plan | canada</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Backend Lesson Plan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="we love canada" />
<meta property="og:description" content="we love canada" />
<link rel="canonical" href="https://shruthim0.github.io/canada/2023/06/05/Backend-Lesson-Plan.html" />
<meta property="og:url" content="https://shruthim0.github.io/canada/2023/06/05/Backend-Lesson-Plan.html" />
<meta property="og:site_name" content="canada" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-06-05T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Backend Lesson Plan" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-06-05T00:00:00-05:00","datePublished":"2023-06-05T00:00:00-05:00","description":"we love canada","headline":"Backend Lesson Plan","mainEntityOfPage":{"@type":"WebPage","@id":"https://shruthim0.github.io/canada/2023/06/05/Backend-Lesson-Plan.html"},"url":"https://shruthim0.github.io/canada/2023/06/05/Backend-Lesson-Plan.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/canada/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://shruthim0.github.io/canada/feed.xml" title="canada" /><link rel="shortcut icon" type="image/x-icon" href="/canada/images/canadalogo.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/canada/">canada</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/canada/College/">College</a><a class="page-link" href="/canada/CollegeFinder/">College Finder</a><a class="page-link" href="/canada/diceroll/">Dice Roll</a><a class="page-link" href="/canada/sassdemo/">Sass Demo</a><a class="page-link" href="/canada/search/">Search</a><a class="page-link" href="/canada/wheel/">Spin the Wheel</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Backend Lesson Plan</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2023-06-05T00:00:00-05:00" itemprop="datePublished">
        Jun 5, 2023
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      9 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/shruthim0/canada/tree/master/_notebooks/2023-06-05-Backend-Lesson-Plan.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/canada/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/shruthim0/canada/master?filepath=_notebooks%2F2023-06-05-Backend-Lesson-Plan.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/canada/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/shruthim0/canada/blob/master/_notebooks/2023-06-05-Backend-Lesson-Plan.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/canada/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fshruthim0%2Fcanada%2Fblob%2Fmaster%2F_notebooks%2F2023-06-05-Backend-Lesson-Plan.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/canada/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Creation-of-Database">Creation of Database </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Reviews-Database-Creation">Reviews Database Creation </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Creation-of-API">Creation of API </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Reviews-API">Reviews API </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-06-05-Backend-Lesson-Plan.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creation-of-Database">
<a class="anchor" href="#Creation-of-Database" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creation of Database<a class="anchor-link" href="#Creation-of-Database"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="sd">""" database dependencies to support sqliteDB examples """</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">app</span><span class="p">,</span> <span class="n">db</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.exc</span> <span class="kn">import</span> <span class="n">IntegrityError</span>

<span class="k">class</span> <span class="nc">Colleges</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">'Colleges'</span>

    <span class="c1"># Define the colleges schema</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">_college</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_city</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_rate</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_area</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_stufac</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_majors</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">college</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">stufac</span><span class="p">,</span> <span class="n">majors</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_college</span> <span class="o">=</span> <span class="n">college</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_city</span> <span class="o">=</span> <span class="n">city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rate</span> <span class="o">=</span> <span class="n">rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_area</span> <span class="o">=</span> <span class="n">area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stufac</span> <span class="o">=</span> <span class="n">stufac</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_majors</span> <span class="o">=</span> <span class="n">majors</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">college</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_college</span>
    
    <span class="c1"># a setter function, allows exercise name to be updated after initial object creation</span>
    <span class="nd">@college</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">college</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">college</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_college</span> <span class="o">=</span> <span class="n">college</span>

    <span class="k">def</span> <span class="nf">is_college</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">college</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_college</span> <span class="o">==</span> <span class="n">college</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">city</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_city</span>
    
    <span class="nd">@city</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">city</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">city</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_city</span> <span class="o">=</span> <span class="n">city</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rate</span>
    
    
    <span class="nd">@rate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rate</span> <span class="o">=</span> <span class="n">rate</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_area</span>
    
    
    <span class="nd">@area</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">area</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_area</span> <span class="o">=</span> <span class="n">area</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stufac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stufac</span>
    
    
    <span class="nd">@stufac</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">stufac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stufac</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stufac</span> <span class="o">=</span> <span class="n">stufac</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">majors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_majors</span>
    
    
    <span class="nd">@majors</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">majors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">majors</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_majors</span> <span class="o">=</span> <span class="n">majors</span>

    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    
    <span class="c1"># CRUD create, adds a new record to the Colleges table</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># creates a workout object from College(db.Model) </span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>

  
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">"id"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s2">"college"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">college</span><span class="p">,</span>
            <span class="s2">"city"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">city</span><span class="p">,</span>
            <span class="s2">"rate"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">,</span>
            <span class="s2">"area"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="p">,</span>
            <span class="s2">"stufac"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stufac</span><span class="p">,</span>
            <span class="s2">"majors"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">majors</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rate</span><span class="o">=</span><span class="s2">""</span><span class="p">):</span>
        <span class="sd">"""only updates values with length"""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span>
        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>
    

<span class="k">def</span> <span class="nf">initColleges</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
        <span class="sd">"""Create database and tables"""</span>
        <span class="n">db</span><span class="o">.</span><span class="n">create_all</span><span class="p">()</span>
        <span class="sd">"""Tester data for table"""</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UCSD'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'San Diego'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'34%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'urban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'19:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Biology, Cognitive Science, International studies'</span><span class="p">)</span>
        <span class="n">i2</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UCSC'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'Santa Cruz'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'52%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'suburban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'18:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Computer Science, Psychology, Cell/Cellular and Molecular Biology'</span><span class="p">)</span>
        <span class="n">i3</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UCLA'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'Los Angeles'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'12%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'urban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'17:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Sociology, Political Science and Government, and Econometrics and Quantitative Economics'</span><span class="p">)</span>
        <span class="n">i4</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UC Davis'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'LA'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'46%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'suburban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'20:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Research and Experimental Psychology, Management Sciences and Information Systems, Neuroscience and Neurobiology'</span><span class="p">)</span>
        <span class="n">i5</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UC Berkeley'</span><span class="p">,</span><span class="n">city</span><span class="o">=</span><span class="s1">'Berkeley'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'14.4%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'urban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'18:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Cell/Cellular and Molecular Biology, Computer Science, and Econometrics and Quantitative Economics.'</span><span class="p">)</span>
        <span class="n">i6</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UC Riverside'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'Riverside'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'69%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'urban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'22:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Business Administration and Management, Psychology, Biology/Biological Sciences'</span><span class="p">)</span>
        <span class="n">i7</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UC Merced'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'Merced'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'89%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'urban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'20:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Biology/Biological Sciences, Psychology, Business Administration and Management'</span><span class="p">)</span>
        <span class="n">i8</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UCSB'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'Santa Barbara'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'26%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'college town'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'18:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Social Sciences, Biological and Biomedical Sciences, Mathematics and Statistics'</span><span class="p">)</span>
        <span class="n">i9</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="s1">'UC Irvine'</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s1">'Irvine'</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="s1">'41%'</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="s1">'suburban'</span><span class="p">,</span> <span class="n">stufac</span><span class="o">=</span><span class="s1">'18:1'</span><span class="p">,</span> <span class="n">majors</span><span class="o">=</span><span class="s1">'Health-Related Knowledge and Skills, Psychology, Business, Management, Marketing, and Related Support Services'</span><span class="p">)</span>
        
        <span class="n">colleges</span> <span class="o">=</span> <span class="p">[</span><span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span><span class="p">,</span> <span class="n">i4</span><span class="p">,</span> <span class="n">i5</span><span class="p">,</span> <span class="n">i6</span><span class="p">,</span> <span class="n">i7</span><span class="p">,</span> <span class="n">i8</span><span class="p">,</span> <span class="n">i9</span><span class="p">]</span>

       <span class="c1"># """Builds sample college/note(s) data"""</span>
        <span class="k">for</span> <span class="n">college</span> <span class="ow">in</span> <span class="n">colleges</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="sd">'''add a few 1 to 4 notes per user'''</span>
                <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)):</span>
                    <span class="n">note</span> <span class="o">=</span> <span class="s2">"#### "</span> <span class="o">+</span> <span class="n">college</span><span class="o">.</span><span class="n">college</span> <span class="o">+</span> <span class="s2">" note "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">". </span><span class="se">\n</span><span class="s2"> Generated by test data."</span>
                <span class="sd">'''add college data to table'''</span>
                <span class="n">college</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
                <span class="sd">'''fails with bad or duplicate data'''</span>
                <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ERROR </span><span class="si">{</span><span class="n">Colleges</span><span class="o">.</span><span class="n">college</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is how we created the database for the colleges API. First, we define all the variables within the table and create setters and getters for each column. Then, we created the read, create, and delete commands which we can use to read the data in the database on our deployed backend page on a browser. Finally, at the end, we added tester data for each column into the database so we have information on the colleges to then pull to the frontend.</p>
<ul>
<li>In this case, we didn't have to use crud for users to edit the data because the information on the colleges is not meant to be edited. </li>
<li>We also used this format of database creation for the reviews feature of our project</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reviews-Database-Creation">
<a class="anchor" href="#Reviews-Database-Creation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reviews Database Creation<a class="anchor-link" href="#Reviews-Database-Creation"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="sd">""" database dependencies to support sqliteDB examples """</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">app</span><span class="p">,</span> <span class="n">db</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.exc</span> <span class="kn">import</span> <span class="n">IntegrityError</span>


<span class="c1"># Define the Review class to manage actions in the 'reviews' table</span>
<span class="k">class</span> <span class="nc">Review</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">'reviews'</span> 

    <span class="c1"># Define the Review schema with "vars" from object</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">_school</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_review</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># constructor of a Review object, initializes the instance variables within object (self)</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">school</span><span class="p">,</span> <span class="n">review</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_school</span> <span class="o">=</span> <span class="n">school</span>    <span class="c1"># variables with self prefix become part of the object, </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_review</span> <span class="o">=</span> <span class="n">review</span>

    <span class="c1"># a name getter method, extracts name from object</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">school</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_school</span>
    
    <span class="c1"># a setter function, allows name to be updated after initial object creation</span>
    <span class="nd">@school</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">school</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">school</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_school</span> <span class="o">=</span> <span class="n">school</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">review</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_review</span>
    
    <span class="nd">@review</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">review</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">review</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_review</span> <span class="o">=</span> <span class="n">review</span>
        
    <span class="k">def</span> <span class="nf">is_review</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">review</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_review</span> <span class="o">==</span> <span class="n">review</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># creates a person object from Review(db.Model) class, passes initializers</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># add prepares to persist person object to Reviews table</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># SqlAlchemy "unit of work pattern" requires a manual commit</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># CRUD read converts self to dictionary</span>
    <span class="c1"># returns dictionary</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">"id"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="s2">"school"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">school</span><span class="p">,</span>
            <span class="s2">"review"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">review</span>
        <span class="p">}</span>

    <span class="c1"># CRUD update: updates review name, password, phone</span>
    <span class="c1"># returns self</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">school</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s2">""</span><span class="p">):</span>
        <span class="sd">"""only updates values with length"""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">review</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">review</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">review</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">review</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">school</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">school</span> <span class="o">=</span> <span class="n">school</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">school</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">school</span> <span class="o">=</span> <span class="n">school</span>
        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1"># CRUD delete: remove self</span>
    <span class="c1"># None</span>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="sd">"""Database Creation and Testing """</span>

<span class="k">def</span> <span class="nf">initReviews</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
        <span class="sd">"""Create database and tables"""</span>
        <span class="c1"># db.init_app(app)</span>
        <span class="n">db</span><span class="o">.</span><span class="n">create_all</span><span class="p">()</span>
        <span class="sd">"""Tester data for table"""</span>
        <span class="n">u1</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="s1">'UCSD'</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s1">'Socially dead :('</span><span class="p">)</span>
        <span class="n">u2</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="s1">'UCSD'</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s1">'Great engineering program'</span><span class="p">)</span>
        <span class="n">u3</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="s1">'UCI'</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s1">'Go anteaters!!!!!!!!!'</span><span class="p">)</span>
        <span class="n">u4</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="s1">'UCM'</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s1">'Nothing fun to do at all around.'</span><span class="p">)</span>
        <span class="n">u5</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="s1">'UCSB'</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s1">'Party School!!!!'</span><span class="p">)</span>
        <span class="n">u6</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="s1">'UCSC'</span><span class="p">,</span> <span class="n">review</span><span class="o">=</span><span class="s1">'Great program, my son goes here'</span><span class="p">)</span>

        <span class="n">reviews</span> <span class="o">=</span> <span class="p">[</span><span class="n">u1</span><span class="p">,</span> <span class="n">u2</span><span class="p">,</span> <span class="n">u3</span><span class="p">,</span> <span class="n">u4</span><span class="p">,</span> <span class="n">u5</span><span class="p">,</span> <span class="n">u6</span><span class="p">]</span>

        <span class="sd">"""Builds sample reviews/note(s) data"""</span>
        <span class="k">for</span> <span class="n">review</span> <span class="ow">in</span> <span class="n">reviews</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="sd">'''add a few 1 to 4 notes per review'''</span>
                <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)):</span>
                    <span class="n">note</span> <span class="o">=</span> <span class="s2">"#### "</span> <span class="o">+</span> <span class="n">review</span><span class="o">.</span><span class="n">school</span> <span class="o">+</span> <span class="s2">" note "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">". </span><span class="se">\n</span><span class="s2"> Generated by test data."</span>
                <span class="sd">'''add review/post data to table'''</span>
                <span class="n">review</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
                <span class="sd">'''fails with bad or duplicate data'''</span>
                <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Records exist, duplicate email, or error: </span><span class="si">{</span><span class="n">review</span><span class="o">.</span><span class="n">review</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creation-of-API">
<a class="anchor" href="#Creation-of-API" aria-hidden="true"><span class="octicon octicon-link"></span></a>Creation of API<a class="anchor-link" href="#Creation-of-API"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">flask_restful</span> <span class="kn">import</span> <span class="n">Api</span><span class="p">,</span> <span class="n">Resource</span> <span class="c1"># used for REST API building</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">model.colleges</span> <span class="kn">import</span> <span class="n">Colleges</span>
<span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">db</span>

<span class="n">college_api</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">'college_api'</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">,</span>
                   <span class="n">url_prefix</span><span class="o">=</span><span class="s1">'/api/colleges'</span><span class="p">)</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">Api</span><span class="p">(</span><span class="n">college_api</span><span class="p">)</span>

<span class="c1"># API docs https://flask-restful.readthedocs.io/en/latest/api.html</span>

<span class="k">class</span> <span class="nc">CollegesAPI</span><span class="p">:</span>        
    <span class="k">class</span> <span class="nc">_Create</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">''' Read data for json body '''</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
            
            <span class="sd">''' Avoid garbage in, error checking '''</span>
            <span class="c1"># validate college</span>

            <span class="n">college</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'college'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">college</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">college</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Input College Name'</span><span class="p">},</span> <span class="mi">210</span>
 
            <span class="n">city</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'city'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">city</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">city</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Input City'</span><span class="p">},</span> <span class="mi">213</span>
                       
            <span class="n">area</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'area'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">area</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Input Area'</span><span class="p">},</span> <span class="mi">210</span>

            <span class="n">rate</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'rate'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Input number of repetitions (must be integer)'</span><span class="p">},</span> <span class="mi">214</span>
            
            <span class="n">stufac</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'stufac'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stufac</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">stufac</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Input Student-Faculty Ratio'</span><span class="p">},</span> <span class="mi">217</span>
            <span class="n">majors</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'majors'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">majors</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">majors</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Input Majors'</span><span class="p">},</span> <span class="mi">217</span>

            <span class="kn">from</span> <span class="nn">model.colleges</span> <span class="kn">import</span> <span class="n">Colleges</span>

            <span class="n">io</span> <span class="o">=</span> <span class="n">Colleges</span><span class="p">(</span><span class="n">college</span><span class="o">=</span><span class="n">college</span><span class="p">,</span>
                        <span class="n">city</span><span class="o">=</span><span class="n">city</span><span class="p">,</span>
                        <span class="n">rate</span><span class="o">=</span><span class="n">rate</span><span class="p">,</span>
                        <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span>
                        <span class="n">stufac</span><span class="o">=</span><span class="n">stufac</span><span class="p">,</span>
                        <span class="n">majors</span><span class="o">=</span><span class="n">majors</span><span class="p">)</span>
            
            <span class="n">Colleges</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>

            <span class="c1"># success returns json of college</span>
            <span class="k">if</span> <span class="n">Colleges</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">Colleges</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="c1"># failure returns error</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Processed </span><span class="si">{</span><span class="n">college</span><span class="si">}</span><span class="s1">, a format error or college </span><span class="si">{</span><span class="n">college</span><span class="si">}</span><span class="s1"> is duplicate'</span><span class="p">},</span> <span class="mi">215</span>
    

    <span class="k">class</span> <span class="nc">_Read</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">colleges</span> <span class="o">=</span> <span class="n">Colleges</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>    <span class="c1"># read/extract all colleges from database</span>
            <span class="n">json_ready</span> <span class="o">=</span> <span class="p">[</span><span class="n">college</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="k">for</span> <span class="n">college</span> <span class="ow">in</span> <span class="n">colleges</span><span class="p">]</span>  <span class="c1"># prepare output in json</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">json_ready</span><span class="p">)</span>  <span class="c1"># jsonify creates Flask response object, more specific to APIs than json.dumps</span>

    <span class="k">class</span> <span class="nc">_Delete</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Colleges</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="s1">'All colleges have been deleted.'</span><span class="p">}</span>


    <span class="c1"># building RESTapi endpoint</span>
    <span class="n">api</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">_Create</span><span class="p">,</span> <span class="s1">'/create'</span><span class="p">)</span>
    <span class="n">api</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">_Read</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span>
    <span class="n">api</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">_Delete</span><span class="p">,</span> <span class="s1">'/delete'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This was the creation of our API in the backend for our colleges database. Here, we used the "from model.colleges import Colleges" command to pull the database we created into the api and create a link we could use to read the database on a browser page. After this, we created a garbage data check to make sure each column of the database table had information. This comes in handy when testing the api with applications like postman. Finally, at the end we used the read, create, and delete functions we made in the database file to build RESTapi endpoints.</p>
<ul>
<li>This code is also used for the review api file for the reviews function (Below)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reviews-API">
<a class="anchor" href="#Reviews-API" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reviews API<a class="anchor-link" href="#Reviews-API"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">flask_restful</span> <span class="kn">import</span> <span class="n">Api</span><span class="p">,</span> <span class="n">Resource</span> <span class="c1"># used for REST API building</span>

<span class="kn">from</span> <span class="nn">model.reviews</span> <span class="kn">import</span> <span class="n">Review</span>
<span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">db</span>

<span class="n">review_api</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">'review_api'</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">,</span>
                   <span class="n">url_prefix</span><span class="o">=</span><span class="s1">'/api/reviews'</span><span class="p">)</span>

<span class="c1"># API docs https://flask-restful.readthedocs.io/en/latest/api.html</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">Api</span><span class="p">(</span><span class="n">review_api</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ReviewPI</span><span class="p">:</span>        
    <span class="k">class</span> <span class="nc">_Create</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">''' Read data for json body '''</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
            
            <span class="sd">''' Avoid garbage in, error checking '''</span>
            <span class="c1"># validate school</span>
            <span class="n">school</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'school'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">school</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">school</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'School is missing, or is less than 2 characters'</span><span class="p">},</span> <span class="mi">400</span>
            <span class="c1"># validate review</span>
            <span class="n">review</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'review'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">review</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">review</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Review is missing'</span><span class="p">},</span> <span class="mi">400</span>

            <span class="sd">''' #1: Key code block, setup REVIEW OBJECT '''</span>
            <span class="n">so</span> <span class="o">=</span> <span class="n">Review</span><span class="p">(</span><span class="n">school</span><span class="o">=</span><span class="n">school</span><span class="p">,</span> 
                      <span class="n">review</span><span class="o">=</span><span class="n">review</span><span class="p">)</span>
            
            
            <span class="sd">''' #2: Key Code block to add REVIEW to database '''</span>
            <span class="c1"># create review in database</span>
            <span class="n">review</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="c1"># success returns json of review</span>
            <span class="k">if</span> <span class="n">review</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">review</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="c1"># failure returns error</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Processed </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s1">, either a format error or rEVEIE </span><span class="si">{</span><span class="n">review</span><span class="si">}</span><span class="s1"> is duplicate'</span><span class="p">},</span> <span class="mi">400</span>

    <span class="k">class</span> <span class="nc">_Read</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">reviews</span> <span class="o">=</span> <span class="n">Review</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>    <span class="c1"># read/extract all REVIEWS from database</span>
            <span class="n">json_ready</span> <span class="o">=</span> <span class="p">[</span><span class="n">review</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="k">for</span> <span class="n">review</span> <span class="ow">in</span> <span class="n">reviews</span><span class="p">]</span>  <span class="c1"># prepare output in json</span>
            <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">json_ready</span><span class="p">)</span>  <span class="c1"># jsonify creates Flask response object, more specific to APIs than json.dumps</span>
    
    <span class="k">class</span> <span class="nc">_Delete</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Review</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="s1">'All reviews have been deleted.'</span><span class="p">}</span>
            

    <span class="c1"># building RESTapi endpoint</span>
    <span class="n">api</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">_Create</span><span class="p">,</span> <span class="s1">'/create'</span><span class="p">)</span>
    <span class="n">api</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">_Read</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">)</span>
    <span class="n">api</span><span class="o">.</span><span class="n">add_resource</span><span class="p">(</span><span class="n">_Delete</span><span class="p">,</span> <span class="s1">'/delete'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>When the backend database and api is functional, we are able to pull information from the database into the frontend table via the API link we created.</strong></p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/canada/2023/06/05/Backend-Lesson-Plan.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/canada/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://shruthim0.github.io/canada/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/canada/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>we love canada</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="â€ https://github.com/nighthawkcoders â€œ" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/canada/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="â€ https://twitter.com/NighthawkCoding â€œ" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/canada/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="â€ https://www.youtube.com/channel/UClIKOsDS5dsfzFA3zveDT3Q â€œ" target="_blank" title="youtube">
    <svg class="svg-icon grey">
      <use xlink:href="/canada/assets/minima-social-icons.svg#youtube"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
